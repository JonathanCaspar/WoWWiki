(this["webpackJsonpwow-wiki"]=this["webpackJsonpwow-wiki"]||[]).push([[0],{109:function(e,t,n){},110:function(e,t,n){},111:function(e,t,n){},113:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),o=n(22),u=n.n(o),s=(n(61),n(24)),l=n(25),i=n(26),m=n(29),d=n(28),p=n(119),f=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={value:""},a.handleCharacterSearch=a.handleCharacterSearch.bind(Object(i.a)(a)),a}return Object(l.a)(n,[{key:"handleCharacterSearch",value:function(e){var t=e.target.value,n=t.length>=1?t.substr(0,1).toUpperCase()+t.substr(1,t.length).toLowerCase():t;this.setState({value:n})}},{key:"render",value:function(){var e=this.props.t;return c.a.createElement("div",{className:"Characters"},c.a.createElement("h2",null,e("characters.title")),c.a.createElement("form",{onSubmit:null},c.a.createElement("label",null,e("characters.name-query"),c.a.createElement("input",{type:"text",value:this.state.value,onChange:this.handleCharacterSearch})),c.a.createElement("input",{type:"submit",value:e("common.load")})))}}]),n}(r.Component),h=Object(p.a)("common")(f),b=n(47),v=n(11),g=n(13),E=n(4),O=n.n(E),j=n(12),k=n(17),y=n(18),x=n(55),w=n(32),z=n.n(w),N="e1d9b7f970f44229bda1942d09d3ce97";function S(){return M.apply(this,arguments)}function M(){return(M=Object(j.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("...Requesting Auth Token"),e.next=3,z.a.post("https://us.battle.net/oauth/token",{},{auth:{username:"".concat(N),password:"".concat("68t8Dc1UBHEX3oQC3nMLXKINoQ7Mz4Ik")},params:{grant_type:"client_credentials"}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return I.apply(this,arguments)}function I(){return(I=Object(j.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("blizzard_token"),n=localStorage.getItem("blizzard_token_expire_time"),null===t){e.next=8;break}if(null===n){e.next=8;break}if(Math.floor(Date.now()/1e3)>n-900){e.next=8;break}return console.log("...found token : "+t),e.abrupt("return",t);case 8:return e.next=10,S().then((function(e){t=e.data.access_token;var n=Math.floor(Date.now()/1e3)+e.data.expires_in;return console.log(e),console.log("... Putting in local storage blizzard_token : "+t),localStorage.setItem("blizzard_token",e.data.access_token),console.log("... Putting in local storage blizzard_token_expire_time : "+n),localStorage.setItem("blizzard_token_expire_time",n),e.data.access_token}),(function(e){return console.log("Blizzard API - error while fetching access token :"+e),null}));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return B.apply(this,arguments)}function B(){return(B=Object(j.a)(O.a.mark((function e(t){var n,a,r,c,o,u,s=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},a=n.body,r=Object(x.a)(n,["body"]),e.next=3,C();case 3:return c=e.sent,o={"Content-Type":"application/json"},u=Object(y.a)(Object(y.a)({method:a?"POST":"GET"},r),{},{headers:Object(y.a)(Object(y.a)(Object(y.a)({},o),r.headers),{},{Authorization:"Bearer ".concat(c)}),validateStatus:function(e){return 200==e}}),a&&(u.body=JSON.stringify(a)),e.abrupt("return",z()(t,Object(y.a)({},u)).then((function(e){return e}),(function(e){return Promise.reject(e.message)})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}_.getMountIndex=function(){var e=Object(j.a)(O.a.mark((function e(t,n,a){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("https://eu.api.blizzard.com/data/wow/mount/index",{params:{region:"".concat(t),namespace:"".concat(n),locale:"".concat(a)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),_.getMountById=function(){var e=Object(j.a)(O.a.mark((function e(t,n,a,r){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("https://eu.api.blizzard.com"+"/data/wow/mount/".concat(t),{params:{region:"".concat(n),namespace:"".concat(a),locale:"".concat(r)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}();var L=Object(k.b)("mounts/fetchMounts",Object(j.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.getMountIndex("eu","static-eu","fr_FR");case 2:return t=e.sent,e.abrupt("return",t.data.mounts);case 4:case"end":return e.stop()}}),e)})))),P=Object(k.b)("mounts/fetchMountById",function(){var e=Object(j.a)(O.a.mark((function e(t,n){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.getMountById(t,"eu","static-eu","fr_FR");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),W=(Object(k.b)("mounts/fetchMountAsset",function(){var e=Object(j.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,_(t.creature_displays[0].key.href);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:return e.abrupt("return",Promise.reject("Need a mount object in order to fetch its asset"));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(k.c)({name:"mounts",initialState:{data:[],status:"idle",error:"null",selectedMountId:null,selectedMountStatus:"idle",selectedMountError:"null"},reducers:{mountSelected:function(e,t){e.selectedMountId=t.payload,e.selectedMountStatus="idle"}},extraReducers:(a={},Object(g.a)(a,L.pending,(function(e){e.status="loading"})),Object(g.a)(a,L.fulfilled,(function(e,t){e.status="succeeded",e.data=e.data.concat(t.payload)})),Object(g.a)(a,L.rejected,(function(e,t){e.status="failed",e.error=t.payload})),Object(g.a)(a,P.pending,(function(e){e.selectedMountStatus="loading"})),Object(g.a)(a,P.fulfilled,(function(e,t){e.selectedMountStatus="succeeded",e.selectedMount=t.payload})),Object(g.a)(a,P.rejected,(function(e,t){e.selectedMountStatus="failed",e.selectedMountError=t.payload})),a)})),q=W.actions.mountSelected,A=W.reducer,F=n(51),J=n.n(F),T=function(){var e=Object(b.a)("common").t;return c.a.createElement("div",null,c.a.createElement("span",null,e("common.loading")," "),c.a.createElement(J.a,{className:"loader",type:"Oval",color:"#00BFFF",height:15,width:15}))},R=(n(109),function(e){var t=e.name,n=e.id,a=e.onClickItem;return c.a.createElement("div",{className:"nav-list-row",onClick:function(){return a(t,n)}},t)});var U=function(){var e,t=Object(v.b)(),n=(Object(b.a)("common").t,Object(v.c)((function(e){return e.mounts.data}))),a=Object(v.c)((function(e){return e.mounts.status}));if(Object(r.useEffect)((function(){"idle"===a&&t(L())}),[a,t]),"loading"===a)e=c.a.createElement(T,null);else if("succeeded"===a){e=n.slice().sort((function(e,t){e.name.localeCompare(t.name)})).map((function(e){return c.a.createElement(R,{name:e.name,id:e.id,onClickItem:function(){t(q(e.id))},key:e.id})}))}else"failed"===a&&(e=c.a.createElement("div",null,"Couldn't load mounts"));return c.a.createElement("div",{className:"nav-list"},e)};n(110);var D=function(){var e,t=Object(v.b)(),n=Object(v.c)((function(e){return e.mounts.selectedMount})),a=Object(v.c)((function(e){return e.mounts.selectedMountId})),o=Object(v.c)((function(e){return e.mounts.selectedMountStatus}));return Object(r.useEffect)((function(){"idle"===o&&a&&t(P(a))}),[a,t]),"loading"===o?e=c.a.createElement(T,null):"succeeded"===o?e=c.a.createElement("div",null,c.a.createElement("div",{className:"mount-name"},n.name),c.a.createElement("div",{className:"mount-desc"},n.description),c.a.createElement("img",{src:"",alt:n.name})):"failed"===o&&(e=c.a.createElement("div",null,"Couldn't load mount")),c.a.createElement("div",{className:"mount-viewer"},e)},Q=(n(111),function(){var e=Object(b.a)("common").t;return c.a.createElement("div",{className:"Mounts"},c.a.createElement("h2",null,e("mounts.title")),c.a.createElement("div",{className:"mounts-nav-container"},c.a.createElement(U,null),c.a.createElement("div",{className:"spacer"}),c.a.createElement(D,null),c.a.createElement("div",{className:"spacer"})))});var X=function(){var e=Object(b.a)("common").t;return c.a.createElement("div",{className:"Pets"},c.a.createElement("h2",null,e("pets.title")))},G=n(52),H=n.n(G),K=n(20),V=(n(113),n(114),function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleBurgerOpen=function(){a.setState((function(e){return{burgerOpen:!e.burgerOpen}}))},a.handleLangChange=function(){var e=a.props.i18n;a.setState((function(t){var n=t.lang,r=a.getNextLang(n);return e.changeLanguage(r),{lang:r}}))},a.state={burgerOpen:!1,lang:"en"},a}return Object(l.a)(n,[{key:"getNextLang",value:function(e){return"en"===e?"fr":"en"}},{key:"render",value:function(){var e=this.props.t,t=this.state,n=t.burgerOpen,a=t.lang,r=this.getNextLang(a);return c.a.createElement("div",{className:"nav-container"},c.a.createElement("div",{className:"nav"},c.a.createElement(H.a,{isOpen:n,onClick:this.handleBurgerOpen}),c.a.createElement("div",{className:"nav-logo"},c.a.createElement("img",{src:"favicon.svg",alt:"logo"}),c.a.createElement("h3",null,"World\xa0of\xa0Warcraft\xa0Wiki")),c.a.createElement("div",{className:"spacer"}),c.a.createElement("div",{className:"nav-links"},c.a.createElement(K.b,{to:"/characters"},e("characters.title")),c.a.createElement(K.b,{to:"/mounts"},e("mounts.title")),c.a.createElement(K.b,{to:"/pets"},e("pets.title"))),c.a.createElement("div",{className:"nav-lang"},c.a.createElement("button",{onClick:this.handleLangChange},r))))}}]),n}(r.Component)),Y=Object(p.a)("common")(V);n(116);var Z=function(){var e=Object(b.a)("common").t;return c.a.createElement("div",{className:"footer"},e("footer.copyright"))},$=n(3);n(117);var ee=function(){return c.a.createElement("div",{className:"app"},c.a.createElement(K.a,null,c.a.createElement(Y,null),c.a.createElement("div",{className:"app-body"},c.a.createElement($.c,null,c.a.createElement($.a,{exact:!0,path:"/",component:h}),c.a.createElement($.a,{path:"/characters",component:h}),c.a.createElement($.a,{path:"/mounts",component:Q}),c.a.createElement($.a,{path:"/pets",component:X})))),c.a.createElement(Z,null))},te=Object(k.a)({reducer:{mounts:A}}),ne=n(120),ae=n(35),re=n(53),ce=n(54);ae.a.init({interpolation:{escapeValue:!1},lng:"en",resources:{en:{common:re},fr:{common:ce}}}),u.a.render(c.a.createElement(v.a,{store:te},c.a.createElement(ne.a,{i18n:ae.a},c.a.createElement(ee,null))),document.getElementById("root"))},53:function(e){e.exports=JSON.parse('{"characters":{"title":"Characters","name-query":"Enter your character name:"},"mounts":{"title":"Mounts"},"pets":{"title":"Pets"},"common":{"load":"Load","loading":"Loading"},"footer":{"copyright":"\xa92004 Blizzard Entertainment, Inc. All rights reserved. World of Warcraft, Warcraft and Blizzard Entertainment are trademarks or registered trademarks of Blizzard Entertainment, Inc. in the U.S. and/or other countries."}}')},54:function(e){e.exports=JSON.parse('{"characters":{"title":"Personnages","name-query":"Saisir le nom de votre personnage :"},"mounts":{"title":"Montures"},"pets":{"title":"Familiers"},"common":{"load":"Charger","loading":"Chargement"},"footer":{"copyright":"\xa92004 Blizzard Entertainment, Inc. Tous droits r\xe9serv\xe9s. World of Warcraft, Warcraft et Blizzard Entertainment sont des marques ou des marques d\xe9pos\xe9es de Blizzard Entertainment, Inc. aux \xc9tats-Unis d\u2019Am\xe9rique et/ou dans d\u2019autres pays."}}')},56:function(e,t,n){e.exports=n(118)},61:function(e,t,n){}},[[56,1,2]]]);
//# sourceMappingURL=main.75a55441.chunk.js.map